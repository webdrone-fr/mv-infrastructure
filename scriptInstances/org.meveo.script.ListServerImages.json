{
  "code" : "org.meveo.script.ListServerImages",
  "inputs" : [ ],
  "outputs" : [ ],
  "generateOutputs" : false,
  "type" : "JAVA",
  "transactionType" : "SAME",
  "script" : "package org.meveo.script;\r\n\r\nimport java.util.Map;\r\n\r\nimport org.meveo.service.script.Script;\r\nimport org.meveo.admin.exception.BusinessException;\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\nimport org.meveo.api.persistence.CrossStorageApi;\r\nimport org.meveo.service.storage.RepositoryService;\r\nimport org.meveo.model.storage.Repository;\r\nimport org.meveo.model.customEntities.ServiceProvider;\r\nimport java.util.List;\r\nimport org.meveo.persistence.CrossStorageService;\r\nimport org.meveo.model.customEntities.CustomEntityTemplate;\r\nimport org.meveo.service.custom.CustomEntityTemplateService;\r\nimport org.meveo.api.exception.EntityDoesNotExistsException;\r\n\r\npublic class ListServerImages extends Script {\r\n\r\n    private static final Logger log = LoggerFactory.getLogger(ListServerImages.class);\r\n\r\n    private CrossStorageApi crossStorageApi = getCDIBean(CrossStorageApi.class);\r\n\r\n    private RepositoryService repositoryService = getCDIBean(RepositoryService.class);\r\n\r\n    private Repository defaultRepo = repositoryService.findDefaultRepository();\r\n  \r\n  \tprivate CrossStorageService crossStorageService = getCDIBean(CrossStorageService.class);\r\n\r\n    private CustomEntityTemplateService customEntityTemplateService = getCDIBean(CustomEntityTemplateService.class);\r\n\t\r\n\t@Override\r\n\tpublic void execute(Map<String, Object> parameters) throws BusinessException {\r\n\t\tsuper.execute(parameters);\r\n      \tServiceProvider sp = new ServiceProvider();\r\n      \tString codeClass = sp.getClass().getSimpleName();\r\n\t\tCustomEntityTemplate cet = customEntityTemplateService.findByCode(codeClass);\r\n      \ttry {\r\n      \t\tList<Map<String, Object>> providers =crossStorageService.find(defaultRepo, cet, null);\r\n          \tlog.info(providers.toString());\r\n        } catch (EntityDoesNotExistsException ex) {\r\n          \tlog.error(\"Entity does not exist : {} : {}\", codeClass, ex.getMessage());\r\n        }\r\n\t}\r\n\t\r\n}",
  "executionRoles" : [ ],
  "sourcingRoles" : [ ],
  "mavenDependencies" : [ ],
  "importScriptInstances" : [ ]
}